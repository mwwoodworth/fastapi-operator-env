(()=>{var e={};e.id=259,e.ids=[259],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7967:(e,t,o)=>{"use strict";o.r(t),o.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=o(7096),a=o(6132),s=o(7284),n=o.n(s),i=o(2564),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);o.d(t,l);let d=["",{children:["dashboard",{children:["copilot-v2",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(o.bind(o,7716)),"/home/mwwoodworth/brainstackstudio/fastapi-operator-env/frontend/app/dashboard/copilot-v2/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(o.bind(o,2642)),"/home/mwwoodworth/brainstackstudio/fastapi-operator-env/frontend/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(o.bind(o,5345)),"/home/mwwoodworth/brainstackstudio/fastapi-operator-env/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(o.t.bind(o,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/home/mwwoodworth/brainstackstudio/fastapi-operator-env/frontend/app/dashboard/copilot-v2/page.tsx"],p="/dashboard/copilot-v2/page",u={require:o,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/copilot-v2/page",pathname:"/dashboard/copilot-v2",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7785:(e,t,o)=>{Promise.resolve().then(o.bind(o,6231))},6231:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>CopilotV2});var r=o(784),a=o(9885),s=o(9139);function CopilotHeader({model:e,onModelChange:t}){return(0,r.jsxs)("div",{className:"flex items-center justify-between border-b p-2",children:[r.jsx("h2",{className:"font-semibold",children:"Copilot V2"}),(0,r.jsxs)("select",{className:"border rounded px-2 py-1 text-sm",value:e,onChange:e=>t(e.target.value),children:[r.jsx("option",{value:"claude",children:"Claude"}),r.jsx("option",{value:"chatgpt",children:"ChatGPT"}),r.jsx("option",{value:"gemini",children:"Gemini"}),r.jsx("option",{value:"disabled",children:"Disabled"})]})]})}function CopilotResponse({role:e,text:t}){let o="user"===e;return r.jsx("div",{className:`w-full flex ${o?"justify-end":"justify-start"}`,children:r.jsx("div",{className:`whitespace-pre-wrap max-w-[80%] px-3 py-2 rounded text-sm ${o?"bg-primary text-primary-foreground":"bg-muted"}`,children:r.jsx("pre",{className:"whitespace-pre-wrap font-sans text-sm",children:t})})})}var n=o(7744),i=o(46);function CopilotV2(){let[e,t]=(0,a.useState)([]),[o,l]=(0,a.useState)(""),[d,c]=(0,a.useState)("claude"),[p,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[x,f]=(0,a.useState)(!1),b=(0,a.useRef)(null);async function send(){if(o.trim()&&"disabled"!==d){l(""),t(e=>[...e,{role:"user",content:o}]),u(!0);try{let e=await (0,n.JB)(o),r=e.results?.[0]?.content_chunk||"";h(r);let a=`Context:
${r}

Prompt:
${o}`,s="claude"===d?i.g:i.j,l=await s(a),c=l.result||l.response||l.completion||"";t(e=>[...e,{role:"ai",content:""}]);let p="";for(let e of c)p+=e,t(e=>{let t=[...e];return t[t.length-1]={role:"ai",content:p},t}),await new Promise(e=>setTimeout(e,20));(0,n.Ei)({project_id:"chat",title:o.slice(0,40),content:`${o}
${c}`,author_id:"user"}).catch(()=>{})}catch(e){t(e=>[...e,{role:"ai",content:"Error"}])}finally{u(!1),setTimeout(()=>b.current?.scrollIntoView({behavior:"smooth"}),50)}}}return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[r.jsx(CopilotHeader,{model:d,onModelChange:c}),m&&r.jsx("button",{onClick:()=>f(!x),className:"self-end text-xs underline mb-1",children:x?"Hide memory":"Show memory"}),x&&m&&r.jsx("div",{className:"border rounded p-2 text-xs whitespace-pre-wrap mb-2 bg-muted",children:m}),(0,r.jsxs)("div",{className:"flex-1 overflow-auto p-2 space-y-2",children:[0===e.length&&!p&&r.jsx("p",{className:"text-sm opacity-60",children:"Ask me anything to begin..."}),e.map((e,t)=>r.jsx(CopilotResponse,{role:e.role,text:e.content},t)),p&&r.jsx("p",{className:"text-sm opacity-60",children:"Loading..."}),r.jsx("div",{ref:b})]}),(0,r.jsxs)(s.E.form,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},onSubmit:e=>{e.preventDefault(),send()},className:"p-2 border-t flex gap-2",children:[r.jsx("input",{value:o,onChange:e=>l(e.target.value),placeholder:"Ask the copilot...",className:"flex-1 border px-3 py-2 rounded"}),r.jsx("button",{type:"submit",disabled:p,className:"bg-primary text-primary-foreground px-4 py-2 rounded",children:"Send"})]})]})}},46:(e,t,o)=>{"use strict";async function promptClaude(e){return fetch("/api/claude",{method:"POST",body:JSON.stringify({prompt:e})}).then(e=>e.json())}async function promptChatGPT(e){return fetch("/api/chatgpt",{method:"POST",body:JSON.stringify({prompt:e})}).then(e=>e.json())}o.d(t,{g:()=>promptClaude,j:()=>promptChatGPT})},7716:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>CopilotV2Page});var r=o(4656);o(3542);var a=o(5153);let s=(0,a.createProxy)(String.raw`/home/mwwoodworth/brainstackstudio/fastapi-operator-env/frontend/components/CopilotV2.tsx`),{__esModule:n,$$typeof:i}=s,l=s.default;function CopilotV2Page(){return r.jsx("div",{className:"h-full flex flex-col",children:r.jsx(l,{})})}}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),o=t.X(0,[570,124,926,181,744],()=>__webpack_exec__(7967));module.exports=o})();